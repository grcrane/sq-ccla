12/02/20

jQuery
<script type="text/javascript" src="https://code.jquery.com/jquery-1.9.1.min.js"></script>

Raw
https://raw.githubusercontent.com/grcrane/sq-ccla/main/code.js
https://raw.githubusercontent.com/grcrane/sq-ccla/main/service_list.js
https://raw.githubusercontent.com/grcrane/sq-ccla/main/style.css

cdn
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/grcrane/sq-ccla@main/code.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/gh/grcrane/sq-ccla@main/service_list.js"></script>
<link rel='stylesheet' href="https://cdn.jsdelivr.net/gh/grcrane/sq-ccla@main/style.css" />

Service List page code

<script>                                     
jQuery(document).ready(function() {                                                        
   getServiceFromGoogle();
})
</script>

<div id=servicePage action="">
  <form id="selectOptions">
    <fieldset>
    <legend>Search</legend>
    <div>
    <label for="year">Service Year:</label>
    <select id=year name="year" onchange="this.form.submit()"></select>
  </div>
  <div>
    <label for="sermonby">Sermon By:</label>
    <select id=sermonby name="sermonby" onchange="this.form.submit()"></select>
  </div>
    <input type=button onclick="javascript: window.location.assign(window.location.pathname);" value="Clear Search">
  </fieldset>
  </form>
  <p>
  <div id="services">
  </div>
</div>

---- Test for older versions of IE  12/22/20

<script>
$( document ).ready(function() {
  var ua = window.navigator.userAgent;
    var msie = ua.indexOf('MSIE '); // IE 10 and older
  
    var trident = ua.indexOf('Trident/'); // IE 11
  if (msie == -1 && trident == -1) { 
    doGalleryShow();
  }
  else {
    var gallery = $('#page  article:first-child section.gallery-section').first().find('figure');
    gallery.closest('section').css('display', 'none'); 
  } 
})
</script>

----- Generate MailChimp html page body code

<h3 class="statusMessage">Click the start button to harvest information.</h3>
<button id="startGather" onclick="do_get_mailchimp()">Start</button>
<button id="copyToClip" onclick="copyToClipboard('div#contentData-wrapper')">Copy to clipboard</button>
<textarea placeholder="insert html" ></textarea>

<ul id="thedata"></ul>
<div id="contentData-wrapper">
<style>
div#contentData-wrapper {
    width: 100%;
    margin: 0 auto;
    margin-bottom: 24px;
    border: 1px solid black;
    padding: 10px;
    font-family: Helvetica;
    font-size: 16px;
    display: none;
}
h2.sectionType {
    text-align: left;
    font-weight: normal;
    color: #0000CD;
    font-size: 32px;
    margin: 24px 0 24px 0;
}
img.theimg {
    width: 150px;
    height: 120px !important;
    object-fit: cover;
    float: left;
    margin-right: 10px;
    margin-bottom: 5px;
    margin-top: 5px;
    margin-top: 5px;
}

div.contentData:not(:first-child) {
    margin-top: 24px;
}

div.contentData:after {
content: "";
clear: both;
display: table; }

p.contentData {
    margin: 0;
    padding: 0;

}
div.title {
    font-weight: bold;
    font-size: 16px;
    color: #4B0082;
}
.datetime {
    font-style: italic;
    font-size: .9em;
}

.startdate {
    color: black;
    font-weight: 700;
}

textarea {
   width: 100%;
   height: 100px;
   display: none;
}
textarea.active {
    display: block;
}
button {
    background-color: #224ba2;
    color: #fff;
    padding: 5px;
    padding: 5px;
    margin-bottom: 5px;
}
button#copyToClip {
    display: none;
}
button.active {
    display: block; 
}

p {
    white-space: normal !important;
}

div.contentData > p:first-of-type {
    margin-top: 0; 
}

div.clearBoth {
    height: 0;
}

</style>
</div>